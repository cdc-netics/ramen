"use strict";(self.webpackChunkramen_frontend=self.webpackChunkramen_frontend||[]).push([[235],{2235:(U,l,i)=>{i.r(l),i.d(l,{DashboardComponent:()=>g,ModulesShellModule:()=>y});var d=i(177),s=i(2526),u=i(467),p=i(4843),f=i(5312),e=i(7705),h=i(1626),M=i(345),c=i(9213),m=i(8834);function C(t,a){1&t&&(e.j41(0,"div",4),e.nrm(1,"div",5),e.j41(2,"p"),e.EFF(3,"Cargando m\xf3dulo..."),e.k0s()())}function b(t,a){if(1&t&&(e.j41(0,"div",6)(1,"mat-icon"),e.EFF(2,"error_outline"),e.k0s(),e.j41(3,"h2"),e.EFF(4,"Error al cargar m\xf3dulo"),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s()()),2&t){const n=e.XpG();e.R7$(6),e.JRh(n.error)}}function P(t,a){if(1&t&&(e.j41(0,"div",15),e.nrm(1,"iframe",16),e.k0s()),2&t){const n=e.XpG(2);e.R7$(1),e.Y8G("src",n.safeUrl,e.f$h)}}function O(t,a){if(1&t){const n=e.RV6();e.j41(0,"div",17)(1,"mat-icon"),e.EFF(2,"open_in_new"),e.k0s(),e.j41(3,"h3"),e.EFF(4,"Este m\xf3dulo se abre en una nueva ventana"),e.k0s(),e.j41(5,"p"),e.EFF(6),e.k0s(),e.j41(7,"button",18),e.bIt("click",function(){e.eBV(n);const r=e.XpG(2);return e.Njj(r.openInNewTab())}),e.j41(8,"mat-icon"),e.EFF(9,"launch"),e.k0s(),e.EFF(10," Abrir M\xf3dulo "),e.k0s()()}if(2&t){const n=e.XpG(2);e.R7$(6),e.JRh(n.resolvedUrl||n.module.baseUrl)}}function _(t,a){if(1&t&&(e.j41(0,"div",15),e.nrm(1,"iframe",19),e.k0s()),2&t){const n=e.XpG(2);e.R7$(1),e.Y8G("src",n.safeUrl,e.f$h)}}function v(t,a){if(1&t&&(e.j41(0,"div",7)(1,"div",8)(2,"div",9)(3,"mat-icon"),e.EFF(4),e.k0s(),e.j41(5,"div")(6,"h2"),e.EFF(7),e.k0s(),e.j41(8,"p"),e.EFF(9),e.k0s()()(),e.j41(10,"div",10)(11,"span",11),e.EFF(12),e.k0s(),e.j41(13,"span",12),e.EFF(14),e.k0s()()(),e.DNE(15,P,2,1,"div",13),e.DNE(16,O,11,1,"div",14),e.DNE(17,_,2,1,"div",13),e.k0s()),2&t){const n=e.XpG();e.R7$(4),e.JRh(n.module.icon||"security"),e.R7$(3),e.JRh(n.module.name),e.R7$(2),e.JRh(n.module.description),e.R7$(2),e.HbH(n.module.embedType),e.R7$(1),e.JRh(n.module.embedType),e.R7$(1),e.HbH(n.module.status),e.R7$(1),e.JRh(n.module.status),e.R7$(1),e.Y8G("ngIf","iframe"===n.module.embedType),e.R7$(1),e.Y8G("ngIf","link"===n.module.embedType),e.R7$(1),e.Y8G("ngIf","proxy"===n.module.embedType)}}let x=(()=>{class t{constructor(n,o,r){this.route=n,this.http=o,this.sanitizer=r,this.module=null,this.safeUrl=null,this.loading=!0,this.error="",this.apiUrl=f.c.apiUrl.replace(/\/$/,""),this.apiBaseUrl=this.apiUrl.replace(/\/api$/,""),this.resolvedUrl=null}ngOnInit(){var n=this;return(0,u.A)(function*(){const o=n.route.snapshot.params.id;try{if(n.module=yield(0,p._)(n.http.get(`${n.apiUrl}/modules/${o}`)),!n.module)return void n.handleErrorState("M\xf3dulo no encontrado");const r=n.getEmbedUrl(o,n.module);if(!r)return void n.handleErrorState("El m\xf3dulo no tiene una URL embebible configurada");n.resolvedUrl=r,"link"!==n.module.embedType&&(n.safeUrl=n.sanitizer.bypassSecurityTrustResourceUrl(r)),n.loading=!1,console.log("\u2705 M\xf3dulo cargado:",n.module.name,"- embed URL:",r,"- embedType:",n.module.embedType)}catch(r){console.error("\u274c Error cargando m\xf3dulo:",r),n.handleErrorState(r.error?.error||"Error al cargar el m\xf3dulo")}})()}openInNewTab(){this.resolvedUrl&&window.open(this.resolvedUrl,"_blank")}resolveUrl(n){if(!n)return null;if(/^https?:\/\//i.test(n))return n;const o=n.startsWith("/")?"":"/";return`${this.apiBaseUrl}${o}${n}`}getEmbedUrl(n,o){if(console.log("[getEmbedUrl] moduleId:",n),console.log("[getEmbedUrl] module.useProxy:",o.useProxy),console.log("[getEmbedUrl] module.embedType:",o.embedType),console.log("[getEmbedUrl] module.baseUrl:",o.baseUrl),o.useProxy){const r=`${this.apiBaseUrl}/proxy/${n}`;return console.log("[getEmbedUrl] Usando PROXY:",r),r}if("proxy"===o.embedType)return this.resolveUrl(o.baseUrl)||(o.devPort?`http://localhost:${o.devPort}`:null);if("iframe"===o.embedType||"link"===o.embedType){const r=this.resolveUrl(o.baseUrl);return console.log("[getEmbedUrl] Usando URL DIRECTA:",r),r}return null}handleErrorState(n){this.error=n,this.loading=!1}static{this.\u0275fac=function(o){return new(o||t)(e.rXU(s.nX),e.rXU(h.Qq),e.rXU(M.up))}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-module-viewer"]],decls:4,vars:3,consts:[[1,"module-viewer-container"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],["class","module-content",4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[1,"module-content"],[1,"module-header"],[1,"module-info"],[1,"module-meta"],[1,"badge"],[1,"badge","status"],["class","iframe-container",4,"ngIf"],["class","link-container",4,"ngIf"],[1,"iframe-container"],["frameborder","0","allowfullscreen","",1,"module-iframe",3,"src"],[1,"link-container"],["mat-raised-button","","color","primary",3,"click"],["frameborder","0",1,"module-iframe",3,"src"]],template:function(o,r){1&o&&(e.j41(0,"div",0),e.DNE(1,C,4,0,"div",1),e.DNE(2,b,7,1,"div",2),e.DNE(3,v,18,12,"div",3),e.k0s()),2&o&&(e.R7$(1),e.Y8G("ngIf",r.loading),e.R7$(1),e.Y8G("ngIf",r.error&&!r.loading),e.R7$(1),e.Y8G("ngIf",!r.loading&&!r.error&&r.module))},dependencies:[d.bT,c.An,m.$z],styles:[".module-viewer-container[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;background:#f5f5f5}.loading-state[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:1rem}.loading-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:64px;width:64px;height:64px;color:#999}.loading-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;color:#666}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .error-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#999}.spinner[_ngcontent-%COMP%]{width:48px;height:48px;border:4px solid #e0e0e0;border-top-color:#667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.error-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#f44336}.error-state[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#f44336}.module-content[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column}.module-header[_ngcontent-%COMP%]{background:white;padding:1.5rem 2rem;border-bottom:1px solid #e0e0e0;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 4px #0000000d}.module-header[_ngcontent-%COMP%]   .module-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.module-header[_ngcontent-%COMP%]   .module-info[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;color:#667eea}.module-header[_ngcontent-%COMP%]   .module-info[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:500;color:#333}.module-header[_ngcontent-%COMP%]   .module-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.25rem 0 0;color:#666;font-size:.9rem}.module-header[_ngcontent-%COMP%]   .module-meta[_ngcontent-%COMP%]{display:flex;gap:.5rem}.module-header[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:.25rem .75rem;border-radius:12px;font-size:.75rem;font-weight:500;text-transform:uppercase}.module-header[_ngcontent-%COMP%]   .badge.iframe[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.module-header[_ngcontent-%COMP%]   .badge.proxy[_ngcontent-%COMP%]{background:#f3e5f5;color:#7b1fa2}.module-header[_ngcontent-%COMP%]   .badge.link[_ngcontent-%COMP%]{background:#fff3e0;color:#f57c00}.module-header[_ngcontent-%COMP%]   .badge.status.online[_ngcontent-%COMP%], .module-header[_ngcontent-%COMP%]   .badge.status.running[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.module-header[_ngcontent-%COMP%]   .badge.status.offline[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.iframe-container[_ngcontent-%COMP%]{flex:1;position:relative;overflow:hidden;background:white}.iframe-container[_ngcontent-%COMP%]   .module-iframe[_ngcontent-%COMP%]{width:100%;height:100%;border:none}.link-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1rem;background:white}.link-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:80px;width:80px;height:80px;color:#667eea}.link-container[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333}.link-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-family:monospace}.link-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:1rem}.link-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;margin-right:.5rem}"]})}}return t})(),g=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275cmp=e.VBU({type:t,selectors:[["app-dashboard"]],decls:4,vars:0,template:function(o,r){1&o&&(e.j41(0,"h2"),e.EFF(1,"Dashboard de M\xf3dulos"),e.k0s(),e.j41(2,"p"),e.EFF(3,"Aqu\xed se cargar\xe1n los m\xf3dulos din\xe1micamente"),e.k0s())},encapsulation:2})}}return t})(),y=(()=>{class t{static{this.\u0275fac=function(o){return new(o||t)}}static{this.\u0275mod=e.$C({type:t})}static{this.\u0275inj=e.G2t({imports:[d.MD,c.m_,m.Hl,s.iI.forChild([{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",component:g},{path:":id",component:x}])]})}}return t})()}}]);